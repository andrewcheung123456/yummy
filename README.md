# yummy plan started

## 数据库锁

### 锁的分类
* 基于锁的属性分类：共享锁、排它锁
* 基于锁的粒度分类：表锁、行锁（记录锁、间隙锁、临键锁）
* 基于锁的状态分类：意向共享锁、意向排它锁
* 死锁

### 锁的模式
* 读意向锁
* 写意向锁
* 读锁
* 写锁
* 自增锁

### 共享锁
* 共享锁通过lock in share mode实现

### 排它锁
* 排它锁通过for update实现

### 表锁与行锁
* lock table user read(write) 锁表或锁行
* unlock tables 解锁表或者解锁行

### 记录锁
* 记录锁基于主键列或者唯一索引列表，需要精确匹配
### 间隙锁
* 间隙锁锁住的是区间，不包含开始和结束位置的行
* 间隙锁基于非唯一索引
* 间隙锁是左开右开区间数据
### 临建锁
* 临键锁是一种特殊的间隙锁
* 临键锁是左开右闭区间数据
* 临键锁可以解决幻读问题
#### 在根据非唯一索引对记录行进行UPDATE\FOR UPDATE\LOCK IN SHARE MODE操作时，InnoDB会获取该记录行的临键锁，并同时获取该记录行下一个区间的间隙锁。